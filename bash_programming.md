# 变量和参数

变量是编程语言和脚本语言如何表示数据的方式。
变量只不过是个标签，一个分配给一个或一组计算机内存位置的名称。

变量出现在算术运算、数量操作和字符串解析中。

## 变量替换（引用）
变量的名是其值的占位符，即它所保存的数据。引用（检索）它的值被成为变量替换。

* $ 

	让我们仔细区分变量的名称和值。如果variable1是变量的名称，那么$variable1就是对其值的引用，即它包含的数据项。

* 如

	variable1=23
	echo $variable1

只有在声明或赋值、取消设置、导出、在双括号结构内、或是在表示信号的特殊情况下变量才会表现为“裸”。 

赋值可能在等号、read语句、循环头部中出现。


用双引号括起引用的值不会干扰变量替换。这被称为部分替换。有时也称为“弱引用”。

使用单引号会使变量名被当成字面量来使用，并且不会发生替换。这是完全引用。有时也称为“强引用”。

注意$variable实际上是${variable}的简化形式。在$variable导致错误的上下文中，较长的形式可能有效。


## 变量赋值

* =

	赋值运算符（前后没有空格）


	不要混淆=和-eq, -eq是测试，而不是赋值。

	注意：= 可以是赋值运算符也可以是测试运算符，具体依赖于场景。


* 反引号

	反引号可以用于命令替换。
	命令替换是指重新分配一个或多个命令的输出。
	
	使用$(...)机制的变量赋值（比反引号更新的方法）。也是命令替换的一种形式。

	
* 如

	a=`ls -l`
	
	R=$(cat /etc/redhat-release)
	
## Bash变量是非类型化的

与许多其他编程语言不同，Bash不按类型分隔变量。基本上，Bash变量都是字符串，但是根据上下文，Bash允许对变量进行算术运算和比较。
决定性因素是：变量的值是否只包含数字。


bash中当引用一个未声明的变量时，变量的值为空值null。
空值在算术运算中只可以当右值来使用。

## 特殊变量类型

* 局部变量


	仅在代码块或函数中可见的变量

* 环境变量
	
	影响外壳和用户界面行为的变量
	在一个更一般的上下文中，每一个进程都有一个环境。那是，一组进程可能引用的变量。
	从这个意义上说，shell的行为与任何其他进程一致。

	每次外壳启动时，它都会创建与自己环境变量对应的外壳变量。更新或添加环境变量会导致外壳更新它的环境，所有外壳的子进程（它执行的命令）都会继承这个环境。

	环境的大小是有限的。创建过多的环境变量或占用过多空间的环境变量可能导致问题。


	如果一个脚本设置了环境变量，它们需要被导出，那是，报告给脚本本地的环境。

	一个脚本只能导出变量到子进程，也就是，只能导出到特定脚本启动的命令或进程中。
从命令行中调用的脚本无法将变量导出回命令行环境。子进程无法将变量导出回生成他们的父进程。

* 位置参数
	

	从命令行传给脚本的参数： $0, $1, $2, $3...
	$0 是脚本名本身，$1是第一个参数，$2是第二个参数，$3是第三个参数，以此类推。在$9后，参数必须用大括号括起来。
	例如： ${10}, ${11}

	$* 所有位置参数, 看成一个单词。
	$@ 所有位置参数，参数是完整地传达的，没有解释或扩展。这意味着除别的事情外，每一个在参数列表中的参数都会看成一个独立的单词。

	$# 表示命令行参数的数量，或函数占位参数的是这样的。

## 间接引用

我们知道要引用一个变量的值，要用$var形式，
但是如果要引用一个变量的值对应的变量的值，那是要如何处理呢？

$$var么?

这将得到当<前进程进程号>+var

$$ 在bash中是特殊变量，表示当前进程id
\$$var把第一个美元符号在解析时逃逸了，并被放置到var的值前。

但是\$$var得到的只是"$+<var的值>"
需要得到var的值对应的变量的值，还需要继续仔细eval指令。

即：
	eval \$$var


例如：
	a=hello_world
	hello_word=z
	
	\$$a的结果就是$hello_world

bash2中为间接引用提供了新的语法。
${!var}

!var表示使用var的值做变量名

	
## bash的字符串维护相关指令

bash支持令人震惊的数量惊人的字符串维护操作。
不幸地是，这些工具缺乏一个统一的重心。
一些是**参数替换**的子集，
另一些掉落在**UNIX expr**指令中。
这个导致了不一致的命令语法和重叠的功能，
更不用说混乱了。

* 字符串长度

${#变量名}
expr length $变量名
expr "$变量名" : '.*'

和$一起用的#号，经常有表示长度的意思。
如$# 表示命令行参数参数个数

例如：
var=hello
echo ${#var} #显示5
echo `expr length $var` #显示5

* 字符串删除

${变量名#模式}
从左边开始删除最短匹配的字符串

${变量名##模式}
从左边开始删除最长匹配的字符串

${变量名%模式}
从右边开始删除最短匹配的字符串

${变量名%%模式}
从最右边开始删除最长匹配的字符串


模式支持星号*

## 函数

bash脚本中是支持函数的，就像其他真正的编程语言一样。

bash中声明函数可以用以下三种方式：

1. 以function开头，带括号
	function 函数名 () {
		指令。。。
	}

2. 以function开头，不带括号
	function 函数名 {
		指令。。。
	}

3. 和c语言类似，直接不用function关键字，但要加括号
	函数名() {
		指令。。。
	}


**函数的调用方式是直接用函数名+参数列表**
	func $arg1 $arg2

	函数名与参数、参数之间使用空格分隔
	和在bash命令行中单独调用一个程序、内部指令的方式一致
	从逻辑上来说，一个bash脚本对bash来说也是一个函数
	所以，所以函数获取参数的方式也是用$1, $2....
	
		






	





