# 浮点数误差产生的原因

在金融计算中浮点数误差存在的原因是：
   对一些十进制小数我们无法精确地用二进制的方式来表示。
   例如：
      0.4 其实就是 10分之4，这个分数是不能精确地转换为2进制的小数。
      因为二进值的每一位的基数和十进制是不同的。
      十进制是 1/10、1/100、1/1000、1/10000等。。。。
      二进制是 1/2、1/4、1/8、1/16、1/32等。。。。

对64位double来说，对应10进制的有效位数大概是15位数。如果保留两位小数的话可以表示到万亿的数了。

浮点数计算的误差扩大主要体现在乘法。
如原来误差是万分之1， 乘1万后误差也扩大了1万倍。正常加减除问题不大。

以股票业务为例子：
如一个股票价格为
1024.004 转换为二进制时的误差为10的15-7=8 + 3(原来有3个小数位) 负11次方左右。
如果一个客户买入了100万股(10的6次方) 这将把误差扩大到10的负5(11-6=5)次方左右。

因为我们业务只是需要确保误差在10的-3次方以内所以还是没有问题的。

在展现为10进制的表现形式时加上精度修正值再展现即可。






   
